<div class="detail_employee">
  <div class="header">
    <h2 class="title">{{ "title.detailDevice" | translate }}</h2>
    <span *ngIf="estate" (click)="handleBack()"
      ><i class="bi bi-arrow-left-short"></i
    ></span>
  </div>
  <div class="detail_info">
    <div class="export">
      <button
        *ngIf="estate"
        (click)="displayBorrow()"
        pButton
        [label]="'common.requestToBorrow' | translate"
        class="p-button-warning p-button-sm"
        icon="bi bi-airplane"
      ></button>
      <button
        *ngIf="estate"
        (click)="displayQr = true"
        pButton
        label="QR"
        class="p-button-warning p-button-sm"
        icon="bi bi-qr-code-scan"
      ></button>
      <button
        (click)="exportFile()"
        pButton
        [label]="'common.exportExcel' | translate"
        class="p-button-warning p-button-sm"
        icon="bi bi-download"
      ></button>
    </div>

    <div class="detail_table">
      <p-table [value]="deviceList" styleClass="p-datatable-gridlines">
        <ng-template pTemplate="header"></ng-template>
        <ng-template pTemplate="body" let-info>
          <tr>
            <td style="text-align: start; font-weight: 500">{{ info.name }}</td>
            <td style="width: 80%; text-align: start">
              {{ info.value }}
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="footer">
          <tr class="sub_table">
            <td>{{ "createDevice.upgradeContent" | translate }}</td>
            <td colspan="2">
              <p-table
                responsiveLayout="stack"
                [breakpoint]="'580px'"
                [value]="repairInfoList"
              >
                <ng-template pTemplate="header">
                  <tr>
                    <th>{{ "createDevice.content" | translate }}</th>
                    <th>{{ "createDevice.day" | translate }}</th>
                    <th>{{ "createDevice.AmountOfMoney" | translate }}</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-repair>
                  <tr>
                    <td>
                      <span class="p-column-title">{{
                        "createDevice.content" | translate
                      }}</span
                      >{{ repair.content_updated }}
                    </td>
                    <td>
                      <span class="p-column-title">{{
                        "createDevice.day" | translate
                      }}</span
                      >{{ repair.date_updated }}
                    </td>
                    <td>
                      <span class="p-column-title">{{
                        "createDevice.AmountOfMoney" | translate
                      }}</span
                      >{{ repair.total_amount }}
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <!-- <div class="edit">
    <button
      pButton
      [label]="'common.update' | translate"
      class="p-button-outlined p-button-sm"
    ></button>
  </div> -->
</div>

<p-dialog [modal]="true" [(visible)]="displayHistoryBorrow">
  <ng-template pTemplate="header"
    ><h3 class="title">
      {{ "common.historyBorrow" | translate }}
    </h3></ng-template
  >
  <ng-template pTemplate="content">
    <p-table [value]="historyBorrow" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>Code</th>
          <th>Name</th>
          <th>Category</th>
          <th>Quantity</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-history>
        <tr>
          <td>{{ history.code }}</td>
          <td>{{ history.name }}</td>
          <td>{{ history.category }}</td>
          <td>{{ history.quantity }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="footer">
        <app-load-small *ngIf="loadDisplay"></app-load-small>
      </ng-template>
    </p-table>
    <div class="no_data" *ngIf="!loadDisplay && total === 0">
      {{ "common.noData" | translate }}
    </div>
    <p-paginator
      *ngIf="total > 0"
      (onPageChange)="onPageChange($event)"
      [first]="0"
      [rows]="limit"
      [totalRecords]="total"
      [showFirstLastIcon]="false"
    ></p-paginator>
    <div style="text-align: end">
      <button
        (click)="displayCreateRequest = true"
        pButton
        [label]="'common.createRequest' | translate"
        class="p-button-sm p-button-raise"
      ></button>
    </div>
  </ng-template>
</p-dialog>

<p-dialog [modal]="true" [(visible)]="displayCreateRequest">
  <ng-template pTemplate="header"
    ><h3 class="title">
      {{ "common.createRequest" | translate }}
    </h3></ng-template
  >
  <ng-template pTemplate="content">
    <div class="request">
      <form (ngSubmit)="onSubmit()" [formGroup]="requestForm" action="">
        <div class="form_item">
          <label
            ><span>{{ "createEmployee.time" | translate }}</span></label
          >
          <p-calendar
            formControlName="time"
            selectionMode="range"
            [showButtonBar]="true"
            dateFormat="dd.mm.yy"
          ></p-calendar>
        </div>
        <div class="form_item">
          <label
            ><span>{{ "createDevice.content" | translate }}</span></label
          >
          <textarea
            formControlName="description"
            id="float-input"
            rows="5"
            cols="30"
            pInputTextarea
            [autoResize]="true"
          ></textarea>
        </div>

        <div style="text-align: center; margin-top: 10px">
          <button
            type="submit"
            pButton
            [label]="'common.createRequest' | translate"
            class="p-button-sm p-button-raise"
          ></button>
        </div>
      </form>
    </div>
  </ng-template>
</p-dialog>

<p-dialog [modal]="true" class="qr" [(visible)]="displayQr">
  <ng-template pTemplate="header"><h3 class="title">QR Code</h3></ng-template>
  <ng-template pTemplate="content">
    <ngx-qrcode
      [elementType]="elementType"
      [value]="url"
      cssClass="aclass"
      [errorCorrectionLevel]="correctionLevel"
    >
    </ngx-qrcode>
    <div style="text-align: center; margin-top: 10px">
      <button
        (click)="downQrCode()"
        pButton
        [label]="'common.save' | translate"
      ></button>
    </div>
  </ng-template>
</p-dialog>
